[1;35mlet
[0m    [1;32mtype [0many[1;35m = [0m{any:[1;30mint[0m}
    [1;32mvar [0mbuffer[1;35m := [0mgetchar()
    [1;36mfunction [0m[1;33mreadint[0m(any:[1;30many[0m):[1;30mint[0m[1;35m = 
[0m        [1;35mlet
[0m            [1;32mvar [0mi[1;35m := [0m[1;94m0[0m
            [1;36mfunction [0m[1;33misdigit[0m(s:[1;30mstring[0m):[1;30mint[0m[1;35m = 
[0m                ord(buffer) [1;31m>=[0m ord([91m0[0m) [1;31m&[0m ord(buffer) [1;31m<=[0m ord([91m9[0m)

            [1;36mfunction [0m[1;33mskipto[0m()[1;35m = 
[0m                [1;34mwhile [0mbuffer [1;31m=[0m [91m [0m [1;31m|[0m buffer [1;31m=[0m [91m\n[0m[1;34m do 
[0m                    buffer[1;35m := [0mgetchar()
        [1;35min
[0m            (
            skipto(); 
            any.any[1;35m := [0misdigit(buffer); 
            [1;34mwhile [0misdigit(buffer)[1;34m do 
[0m                (
                i[1;35m := [0mi [1;31m*[0m [1;94m10[0m [1;31m+[0m ord(buffer) [1;31m-[0m ord([91m0[0m); 
                buffer[1;35m := [0mgetchar()
                ); 
            i
            )
        [1;35mend
[0m
    [1;32mtype [0mlist[1;35m = [0m{first:[1;30mint[0m, rest:[1;30mlist[0m}
    [1;36mfunction [0m[1;33mreadlist[0m():[1;30mlist[0m[1;35m = 
[0m        [1;35mlet
[0m            [1;32mvar [0many[1;35m := [0many {any = [1;94m0[0m}
            [1;32mvar [0mi[1;35m := [0mreadint(any)
        [1;35min
[0m            (
            [1;34mif [0many.any[1;34m then
[0m                list {rest = readlist(), first = i}
            [1;34melse
[0m                nil
            )
        [1;35mend
[0m

    [1;36mfunction [0m[1;33mmerge[0m(a:[1;30mlist[0m, b:[1;30mlist[0m):[1;30mlist[0m[1;35m = 
[0m        [1;34mif [0ma [1;31m=[0m nil[1;34m then
[0m            b
        [1;34melse
[0m            [1;34mif [0mb [1;31m=[0m nil[1;34m then
[0m                a
            [1;34melse
[0m                [1;34mif [0ma.first [1;31m<[0m b.first[1;34m then
[0m                    list {rest = merge(a.rest, b), first = a.first}
                [1;34melse
[0m                    list {rest = merge(a, b.rest), first = b.first}

    [1;36mfunction [0m[1;33mprintint[0m(i:[1;30mint[0m)[1;35m = 
[0m        [1;35mlet
[0m            [1;36mfunction [0m[1;33mf[0m(i:[1;30mint[0m)[1;35m = 
[0m                [1;34mif [0mi [1;31m>[0m [1;94m0[0m[1;34m then
[0m                    (
                    f(i [1;31m/[0m [1;94m10[0m); 
                    print(chr(i [1;31m-[0m i [1;31m/[0m [1;94m10[0m [1;31m*[0m [1;94m10[0m [1;31m+[0m ord([91m0[0m)))
                    )
        [1;35min
[0m            (
            [1;34mif [0mi [1;31m<[0m [1;94m0[0m[1;34m then
[0m                (
                print([91m-[0m); 
                f(-i)
                )
            [1;34melse
[0m                [1;34mif [0mi [1;31m>[0m [1;94m0[0m[1;34m then
[0m                    f(i)
                [1;34melse
[0m                    print([91m0[0m)
            )
        [1;35mend
[0m

    [1;36mfunction [0m[1;33mprintlist[0m(l:[1;30mlist[0m)[1;35m = 
[0m        [1;34mif [0ml [1;31m=[0m nil[1;34m then
[0m            print([91m\n[0m)
        [1;34melse
[0m            (
            printint(l.first); 
            print([91m [0m); 
            printlist(l.rest)
            )
    [1;32mvar [0mlist1[1;35m := [0mreadlist()
    [1;32mvar [0mlist2[1;35m := [0m(
    buffer[1;35m := [0mgetchar(); 
    readlist()
    )
[1;35min
[0m    (
    printlist(merge(list1, list2))
    )
[1;35mend
[0m